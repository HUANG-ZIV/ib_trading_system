# IB Trading System - å°ˆæ¡ˆå®Œæ•´èªªæ˜

## æœ€å¾Œæ›´æ–°ï¼š2024-12-14

---

## ç›®éŒ„

1. [å°ˆæ¡ˆæ¦‚è¿°](#å°ˆæ¡ˆæ¦‚è¿°)
2. [ç’°å¢ƒè¨­å®š](#ç’°å¢ƒè¨­å®š)
3. [å°ˆæ¡ˆçµæ§‹](#å°ˆæ¡ˆçµæ§‹)
4. [å¿«é€Ÿå•Ÿå‹•](#å¿«é€Ÿå•Ÿå‹•)
5. [å·²å®‰è£å¥—ä»¶](#å·²å®‰è£å¥—ä»¶)
6. [ç›®å‰äº¤æ˜“è¨­å®š](#ç›®å‰äº¤æ˜“è¨­å®š)
7. [TWS è¨­å®š](#tws-è¨­å®š)
8. [å·²é©—è­‰åŠŸèƒ½](#å·²é©—è­‰åŠŸèƒ½)
9. [å¸¸ç”¨å‘½ä»¤](#å¸¸ç”¨å‘½ä»¤)
10. [Git æ“ä½œ](#git-æ“ä½œ)
11. [å·²çŸ¥å•é¡Œèˆ‡è§£æ±ºæ–¹æ¡ˆ](#å·²çŸ¥å•é¡Œèˆ‡è§£æ±ºæ–¹æ¡ˆ)
12. [å¾…å®Œæˆé …ç›®](#å¾…å®Œæˆé …ç›®)
13. [ä¸‹æ¬¡å°è©±é–‹å ´ç™½](#ä¸‹æ¬¡å°è©±é–‹å ´ç™½)

---

## å°ˆæ¡ˆæ¦‚è¿°

é€™æ˜¯ä¸€å€‹åŸºæ–¼ Interactive Brokers API çš„è‡ªå‹•äº¤æ˜“ç³»çµ±ï¼Œä½¿ç”¨ Python é–‹ç™¼ã€‚
- **GitHub**: https://github.com/HUANG-ZIV/ib_trading_system
- **é–‹ç™¼è€…**: HUANG-ZIV
- **ç”¨é€”**: å¤–åŒ¯è‡ªå‹•äº¤æ˜“ï¼ˆå¯æ“´å±•è‡³è‚¡ç¥¨ã€æœŸè²¨ï¼‰

---

## ç’°å¢ƒè¨­å®š

| é …ç›® | è¨­å®šå€¼ |
|------|--------|
| Python ç‰ˆæœ¬ | **3.12**ï¼ˆä¸è¦ç”¨ 3.14ï¼Œèˆ‡ ib_insync ä¸ç›¸å®¹ï¼‰ |
| è™›æ“¬ç’°å¢ƒè·¯å¾‘ | `/Users/zivhuang/Documents/VS code/venv312` |
| å°ˆæ¡ˆè·¯å¾‘ | `/Users/zivhuang/Documents/VS code/ib_trading_system` |
| IB ç«¯å£ | 7497ï¼ˆPaper Tradingï¼‰ |

---

## å°ˆæ¡ˆçµæ§‹

```
ib_trading_system/
â”‚
â”œâ”€â”€ run_live.py                 # ğŸš€ ä¸»ç¨‹å¼å…¥å£ï¼ˆå¤–åŒ¯äº¤æ˜“ï¼‰
â”œâ”€â”€ run_backtest.py             # å›æ¸¬å•Ÿå‹•è…³æœ¬
â”œâ”€â”€ main.py                     # å‚™ç”¨ä¸»ç¨‹å¼
â”‚
â”œâ”€â”€ config/                     # âš™ï¸ é…ç½®æ¨¡çµ„
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ settings.py             # å…¨å±€é…ç½®ï¼ˆå¾ç’°å¢ƒè®Šæ•¸è¼‰å…¥ï¼‰
â”‚   â”œâ”€â”€ trading_modes.py        # äº¤æ˜“æ¨¡å¼é…ç½®
â”‚   â””â”€â”€ symbols.py              # äº¤æ˜“æ¨™çš„å®šç¾©
â”‚
â”œâ”€â”€ core/                       # ğŸ”§ æ ¸å¿ƒæ¨¡çµ„
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ connection.py           # IB é€£æ¥ç®¡ç†
â”‚   â”œâ”€â”€ contracts.py            # åˆç´„å·¥å» ï¼ˆè‚¡ç¥¨/å¤–åŒ¯/æœŸè²¨ï¼‰
â”‚   â”œâ”€â”€ events.py               # äº‹ä»¶å®šç¾©
â”‚   â””â”€â”€ event_bus.py            # äº‹ä»¶ç¸½ç·š
â”‚
â”œâ”€â”€ data/                       # ğŸ“Š æ•¸æ“šæ¨¡çµ„
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ feed_handler.py         # å¸‚å ´æ•¸æ“šæ¥æ”¶
â”‚   â”œâ”€â”€ bar_aggregator.py       # Kç·šèšåˆå™¨
â”‚   â”œâ”€â”€ cache.py                # æ•¸æ“šå¿«å–
â”‚   â””â”€â”€ database.py             # æ•¸æ“šåº«æ“ä½œ
â”‚
â”œâ”€â”€ strategies/                 # ğŸ“ˆ ç­–ç•¥æ¨¡çµ„
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ base.py                 # ç­–ç•¥åŸºé¡
â”‚   â”œâ”€â”€ registry.py             # ç­–ç•¥è¨»å†Šå™¨
â”‚   â””â”€â”€ examples/               # ç¯„ä¾‹ç­–ç•¥
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ sma_cross.py        # â­ SMA äº¤å‰ç­–ç•¥
â”‚       â””â”€â”€ tick_scalper.py     # Tick å‰é ­çš®ç­–ç•¥
â”‚
â”œâ”€â”€ risk/                       # ğŸ›¡ï¸ é¢¨æ§æ¨¡çµ„
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ manager.py              # é¢¨éšªç®¡ç†å™¨
â”‚   â”œâ”€â”€ position_sizer.py       # å€‰ä½è¨ˆç®—å™¨
â”‚   â””â”€â”€ circuit_breaker.py      # ç†”æ–·æ©Ÿåˆ¶
â”‚
â”œâ”€â”€ engine/                     # âš¡ å¼•æ“æ¨¡çµ„
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ strategy_engine.py      # ç­–ç•¥åŸ·è¡Œå¼•æ“
â”‚   â””â”€â”€ execution_engine.py     # è¨‚å–®åŸ·è¡Œå¼•æ“
â”‚
â”œâ”€â”€ execution/                  # ğŸ“ åŸ·è¡Œæ¨¡çµ„
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ order_manager.py        # è¨‚å–®ç®¡ç†å™¨
â”‚   â””â”€â”€ order_types.py          # è¨‚å–®é¡å‹
â”‚
â”œâ”€â”€ utils/                      # ğŸ”¨ å·¥å…·æ¨¡çµ„
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ logger.py               # æ—¥èªŒé…ç½®
â”‚   â”œâ”€â”€ market_hours.py         # å¸‚å ´æ™‚é–“å·¥å…·
â”‚   â”œâ”€â”€ time_utils.py           # æ™‚é–“å·¥å…·
â”‚   â”œâ”€â”€ notifier.py             # é€šçŸ¥æœå‹™
â”‚   â””â”€â”€ performance.py          # æ€§èƒ½ç›£æ§
â”‚
â”œâ”€â”€ backtest/                   # ğŸ“‰ å›æ¸¬æ¨¡çµ„
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ engine.py               # å›æ¸¬å¼•æ“
â”‚   â””â”€â”€ data_loader.py          # æ­·å²æ•¸æ“šè¼‰å…¥
â”‚
â”œâ”€â”€ tests/                      # ğŸ§ª æ¸¬è©¦æ¨¡çµ„
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ conftest.py
â”‚   â”œâ”€â”€ test_connection.py
â”‚   â”œâ”€â”€ test_strategies.py
â”‚   â””â”€â”€ test_risk.py
â”‚
â”œâ”€â”€ logs/                       # ğŸ“ æ—¥èªŒç›®éŒ„
â”œâ”€â”€ data_store/                 # ğŸ“ æ•¸æ“šå„²å­˜ç›®éŒ„
â”‚
â”œâ”€â”€ test_ib_connection.py       # IB é€£æ¥æ¸¬è©¦
â”œâ”€â”€ test_ib_multi.py            # å¤šæ–¹å¼é€£æ¥æ¸¬è©¦
â”œâ”€â”€ test_ib_raw.py              # åŸå§‹é€£æ¥æ¸¬è©¦
â”‚
â”œâ”€â”€ requirements.txt            # Python ä¾è³´
â”œâ”€â”€ .env.example                # ç’°å¢ƒè®Šæ•¸ç¯„ä¾‹
â”œâ”€â”€ .gitignore                  # Git å¿½ç•¥æ¸…å–®
â””â”€â”€ README.md                   # å°ˆæ¡ˆèªªæ˜
```

---

## å¿«é€Ÿå•Ÿå‹•

### å•Ÿå‹•äº¤æ˜“ç³»çµ±

```bash
# 1. å•Ÿå‹•è™›æ“¬ç’°å¢ƒ
source "/Users/zivhuang/Documents/VS code/venv312/bin/activate"

# 2. é€²å…¥å°ˆæ¡ˆç›®éŒ„
cd "/Users/zivhuang/Documents/VS code/ib_trading_system"

# 3. ç¢ºä¿ TWS å·²å•Ÿå‹•ä¸¦ç™»å…¥

# 4. åŸ·è¡Œç³»çµ±
python run_live.py

# 5. åœæ­¢ç³»çµ±
# æŒ‰ Ctrl+C
```

### æ¸¬è©¦ IB é€£æ¥

```bash
python test_ib_connection.py
```

---

## å·²å®‰è£å¥—ä»¶

```
ib_insync          # IB API å°è£
pandas             # æ•¸æ“šè™•ç†
numpy              # æ•¸å€¼è¨ˆç®—
loguru             # æ—¥èªŒ
python-dotenv      # ç’°å¢ƒè®Šæ•¸
sqlalchemy         # æ•¸æ“šåº« ORM
aiosqlite          # ç•°æ­¥ SQLite
nest_asyncio       # ç•°æ­¥å…¼å®¹
```

å®‰è£å‘½ä»¤ï¼š
```bash
pip install ib_insync pandas numpy loguru python-dotenv sqlalchemy aiosqlite nest_asyncio
```

---

## ç›®å‰äº¤æ˜“è¨­å®š

### äº¤æ˜“æ¨™çš„ï¼ˆå¤–åŒ¯ï¼Œå…è²»æ•¸æ“šï¼‰
```python
LIVE_SYMBOLS = [
    "EUR/USD",   # æ­å…ƒ/ç¾å…ƒ
    "GBP/USD",   # è‹±éŠ/ç¾å…ƒ
    "USD/JPY",   # ç¾å…ƒ/æ—¥åœ“
    "AUD/USD",   # æ¾³å¹£/ç¾å…ƒ
    "USD/CHF",   # ç¾å…ƒ/ç‘å£«æ³•éƒ
]
```

### ç­–ç•¥é…ç½®
```python
STRATEGY_CONFIG = {
    "sma_cross": {
        "enabled": True,
        "params": {
            "fast_period": 10,      # å¿«ç·šé€±æœŸ
            "slow_period": 20,      # æ…¢ç·šé€±æœŸ
            "position_size": 20000, # äº¤æ˜“å–®ä½
        },
    },
}
```

### é¢¨éšªåƒæ•¸ï¼ˆç’°å¢ƒè®Šæ•¸ï¼‰
```bash
export ACCOUNT_VALUE=100000
export RISK_PER_TRADE=0.01      # æ¯ç­†äº¤æ˜“é¢¨éšª 1%
export MAX_POSITION_PCT=0.1     # æœ€å¤§å€‰ä½ 10%
```

---

## TWS è¨­å®š

| è¨­å®šé …ç›® | å€¼ |
|----------|-----|
| Enable ActiveX and Socket Clients | âœ… å‹¾é¸ |
| Socket port | 7497 |
| Read-Only API | âŒ ä¸å‹¾é¸ |
| ä¸»APIå®¢æˆ¶ID | 1 |
| Allow connections from localhost only | âœ… å‹¾é¸ |

---

## å·²é©—è­‰åŠŸèƒ½

| åŠŸèƒ½ | ç‹€æ…‹ |
|------|------|
| IB TWS é€£æ¥ | âœ… æˆåŠŸ |
| å¸³æˆ¶è³‡è¨Šè®€å– | âœ… æˆåŠŸï¼ˆæ·¨å€¼ $1,111,021.95ï¼‰ |
| å¤–åŒ¯æ•¸æ“šè¨‚é–± | âœ… æˆåŠŸï¼ˆå…è²»ï¼‰ |
| SMA ç­–ç•¥è¼‰å…¥ | âœ… æˆåŠŸ |
| ç³»çµ±ç©©å®šé‹è¡Œ | âœ… æˆåŠŸ |
| GitHub åŒæ­¥ | âœ… æˆåŠŸ |

---

## å¸¸ç”¨å‘½ä»¤

### ç³»çµ±æ“ä½œ
```bash
# å•Ÿå‹•è™›æ“¬ç’°å¢ƒ
source "/Users/zivhuang/Documents/VS code/venv312/bin/activate"

# é€²å…¥å°ˆæ¡ˆ
cd "/Users/zivhuang/Documents/VS code/ib_trading_system"

# åŸ·è¡Œäº¤æ˜“ç³»çµ±
python run_live.py

# æ¸¬è©¦é€£æ¥
python test_ib_connection.py

# æŸ¥çœ‹æ—¥èªŒ
cat logs/trading_*.log
```

### å¥—ä»¶ç®¡ç†
```bash
# å®‰è£å¥—ä»¶
pip install å¥—ä»¶åç¨±

# æŸ¥çœ‹å·²å®‰è£å¥—ä»¶
pip list

# æ›´æ–°å¥—ä»¶
pip install --upgrade å¥—ä»¶åç¨±
```

---

## Git æ“ä½œ

### æ¨é€æ›´æ–°åˆ° GitHub
```bash
git add .
git commit -m "èªªæ˜æ”¹äº†ä»€éº¼"
git push
```

### æŸ¥çœ‹ç‹€æ…‹
```bash
git status
```

### æŸ¥çœ‹æ­·å²
```bash
git log --oneline
```

---

## å·²çŸ¥å•é¡Œèˆ‡è§£æ±ºæ–¹æ¡ˆ

| å•é¡Œ | è§£æ±ºæ–¹æ¡ˆ |
|------|----------|
| Python 3.14 ä¸ç›¸å®¹ | ä½¿ç”¨ Python 3.12 |
| è‚¡ç¥¨æ•¸æ“šéœ€ä»˜è²» | æ”¹ç”¨å¤–åŒ¯ï¼ˆå…è²»ï¼‰ |
| TWS é€£æ¥è¶…æ™‚ | ç¢ºèª API è¨­å®šæ­£ç¢ºï¼Œé‡å•Ÿ TWS |
| event loop éŒ¯èª¤ | ä½¿ç”¨ Python 3.12 + nest_asyncio |

---

## å¾…å®Œæˆé …ç›®

- [ ] å¯¦ç›¤æ¸¬è©¦ï¼ˆç­‰å¾…å¸‚å ´é–‹ç›¤ï¼‰
- [ ] ç­–ç•¥å›æ¸¬é©—è­‰
- [ ] é€šçŸ¥æœå‹™è¨­å®šï¼ˆTelegram/Emailï¼‰
- [ ] æ›´å¤šç­–ç•¥é–‹ç™¼ï¼ˆRSIã€MACD ç­‰ï¼‰
- [ ] ç¸¾æ•ˆå ±è¡¨ç”Ÿæˆ

---

## ä¸‹æ¬¡å°è©±é–‹å ´ç™½

è¤‡è£½ä»¥ä¸‹å…§å®¹é–‹å§‹æ–°å°è©±ï¼š

```
æˆ‘çš„ IB äº¤æ˜“ç³»çµ±å°ˆæ¡ˆåœ¨ https://github.com/HUANG-ZIV/ib_trading_system

ç’°å¢ƒï¼š
- Python 3.12
- è™›æ“¬ç’°å¢ƒï¼švenv312
- IB TWS Paper Tradingï¼ˆç«¯å£ 7497ï¼‰
- ç›®å‰ä½¿ç”¨å¤–åŒ¯äº¤æ˜“ï¼ˆEUR/USD ç­‰ï¼‰

æˆ‘æƒ³è¦...ï¼ˆèªªæ˜ä½ è¦åšä»€éº¼ï¼‰
```

---

## è¯çµ¡è³‡è¨Š

- **GitHub**: https://github.com/HUANG-ZIV/ib_trading_system
- **Email**: ziv.yu.hsiang.huang@gmail.com
